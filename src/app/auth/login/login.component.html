<!-- src/app/auth/login/login.component.html -->
<!-- LOGIN PREMIUM - HTML CORREGIDO SIN SUPERPOSICIONES -->

<div class="login-container">
  <!-- ==================== LADO IZQUIERDO - ANIMACIÓN GYM ==================== -->
  <div class="animation-section">
    <!-- Background Gradient -->
    <div class="gym-background">
      <div class="gradient-overlay"></div>
    </div>

    <!-- Gym Animation -->
    <div class="gym-animation">
      <!-- Logo Principal CENTRADO -->
      <div class="logo-main">
        <div class="logo-circle">
          <mat-icon class="logo-icon">fitness_center</mat-icon>
        </div>
        <h1 class="brand-name">FitNova</h1>
        <p class="brand-tagline">Entrena con Inteligencia Artificial</p>
      </div>

      <!-- PESA 1 - ESQUINA SUPERIOR IZQUIERDA -->
      <div class="weight-1">
        <mat-icon>fitness_center</mat-icon>
      </div>

      <!-- PESA 2 - ESQUINA SUPERIOR DERECHA -->
      <div class="weight-2">
        <mat-icon>sports_gymnastics</mat-icon>
      </div>

      <!-- PESA 3 - ESQUINA INFERIOR IZQUIERDA -->
      <div class="weight-3">
        <mat-icon>self_improvement</mat-icon>
      </div>

      <!-- PERSONA ENTRENANDO - LADO DERECHO -->
      <div class="trainer-figure">
        <div class="trainer-body">
          <mat-icon class="trainer-icon">directions_run</mat-icon>
        </div>
        <div class="trainer-shadow"></div>
      </div>

      <!-- STAT CARD 1 - IZQUIERDA CENTRO -->
      <div class="stat-card-1">
        <mat-icon>trending_up</mat-icon>
        <span>+50% Fuerza</span>
      </div>

      <!-- STAT CARD 2 - DERECHA INFERIOR -->
      <div class="stat-card-2">
        <mat-icon>psychology</mat-icon>
        <span>IA Personal</span>
      </div>

      <!-- Features List en la parte inferior -->
      <div class="features-list">
        <div class="feature-item">
          <mat-icon>check_circle</mat-icon>
          <span>Rutinas generadas por IA</span>
        </div>
        <div class="feature-item">
          <mat-icon>check_circle</mat-icon>
          <span>Análisis postural en tiempo real</span>
        </div>
        <div class="feature-item">
          <mat-icon>check_circle</mat-icon>
          <span>Dashboard para entrenadores</span>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== LADO DERECHO - FORMULARIO LOGIN ==================== -->
  <div class="form-section">
    <div class="login-card" [class.animated]="isFormAnimated">
      <!-- Header -->
      <div class="login-header">
        <h2>¡Bienvenido de vuelta!</h2>
        <p>Accede a tu panel de entrenador</p>
      </div>

      <!-- Formulario -->
      <form [formGroup]="loginForm" (ngSubmit)="onLogin()" class="login-form">
        <!-- Email Field -->
        <div class="form-group">
          <mat-form-field appearance="outline" class="premium-field">
            <mat-label>Correo Electrónico</mat-label>
            <input 
              matInput 
              type="email"
              formControlName="email"
              placeholder="entrenador@fitnova.com"
              autocomplete="email">
            <mat-icon matPrefix>email</mat-icon>
            <mat-error *ngIf="email?.invalid && email?.touched">
              <span *ngIf="email?.hasError('required')">El correo es requerido</span>
              <span *ngIf="email?.hasError('email')">Ingresa un correo válido</span>
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Password Field -->
        <div class="form-group">
          <mat-form-field appearance="outline" class="premium-field">
            <mat-label>Contraseña</mat-label>
            <input 
              matInput 
              [type]="hidePassword ? 'password' : 'text'"
              formControlName="password"
              placeholder="••••••••"
              autocomplete="current-password">
            <mat-icon matPrefix>lock</mat-icon>
            <button 
              mat-icon-button 
              matSuffix 
              type="button"
              (click)="togglePasswordVisibility()"
              class="password-toggle">
              <mat-icon>{{hidePassword ? 'visibility' : 'visibility_off'}}</mat-icon>
            </button>
            <mat-error *ngIf="password?.invalid && password?.touched">
              <span *ngIf="password?.hasError('required')">La contraseña es requerida</span>
              <span *ngIf="password?.hasError('minlength')">Mínimo 6 caracteres</span>
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Remember Me -->
        <div class="form-options">
          <label class="remember-checkbox">
            <input type="checkbox">
            <span class="checkmark"></span>
            Recordarme
          </label>
          <a routerLink="/auth/forgot-password" class="forgot-password">¿Olvidaste tu contraseña?</a>
        </div>

        <!-- Login Button -->
        <button 
          mat-flat-button 
          type="submit"
          class="login-btn"
          [disabled]="isLoading || loginForm.invalid">
          <span *ngIf="!isLoading" class="btn-content">
            <mat-icon>login</mat-icon>
            Iniciar Sesión
          </span>
          <mat-spinner *ngIf="isLoading" diameter="24" class="login-spinner"></mat-spinner>
        </button>
      </form>

      <!-- Admin Registration Section -->
      <div class="admin-section" *ngIf="!isLoadingAdminCheck">
        <!-- Show registration button if available -->
        <div *ngIf="canRegisterAdmin && !showAdminRegister" class="admin-register-btn-container">
          <button
            mat-stroked-button
            type="button"
            class="admin-register-btn"
            (click)="toggleAdminRegister()">
            <mat-icon>admin_panel_settings</mat-icon>
            Registrar Administrador ({{ currentAdmins }}/{{ maxAdmins }})
          </button>
        </div>

        <!-- Admin Registration Form -->
        <div *ngIf="showAdminRegister" class="admin-register-form">
          <div class="admin-form-header">
            <div class="admin-badge-icon">
              <mat-icon>shield</mat-icon>
            </div>
            <h3>Registro de Administrador</h3>
            <div class="admin-counter">
              <span class="counter-badge">{{ currentAdmins + 1 }}/{{ maxAdmins }}</span>
              <span class="counter-text">Administrador {{ currentAdmins + 1 }}</span>
            </div>
          </div>

          <form [formGroup]="adminRegisterForm" (ngSubmit)="onRegisterAdmin()">
            <!-- Display Name -->
            <div class="form-group">
              <mat-form-field appearance="outline" class="premium-field">
                <mat-label>Nombre Completo</mat-label>
                <input
                  matInput
                  type="text"
                  formControlName="displayName"
                  placeholder="Carlos Cusme"
                  autocomplete="name">
                <mat-icon matPrefix>person</mat-icon>
                <mat-error *ngIf="adminDisplayName?.invalid && adminDisplayName?.touched">
                  <span *ngIf="adminDisplayName?.hasError('required')">El nombre es requerido</span>
                  <span *ngIf="adminDisplayName?.hasError('minlength')">Mínimo 3 caracteres</span>
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Email -->
            <div class="form-group">
              <mat-form-field appearance="outline" class="premium-field">
                <mat-label>Correo Electrónico</mat-label>
                <input
                  matInput
                  type="email"
                  formControlName="email"
                  placeholder="admin@fitnova.com"
                  autocomplete="email">
                <mat-icon matPrefix>email</mat-icon>
                <mat-error *ngIf="adminEmail?.invalid && adminEmail?.touched">
                  <span *ngIf="adminEmail?.hasError('required')">El correo es requerido</span>
                  <span *ngIf="adminEmail?.hasError('email')">Ingresa un correo válido</span>
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Password -->
            <div class="form-group">
              <mat-form-field appearance="outline" class="premium-field">
                <mat-label>Contraseña</mat-label>
                <input
                  matInput
                  [type]="hideAdminPassword ? 'password' : 'text'"
                  formControlName="password"
                  placeholder="••••••••"
                  autocomplete="new-password">
                <mat-icon matPrefix>lock</mat-icon>
                <button
                  mat-icon-button
                  matSuffix
                  type="button"
                  (click)="toggleAdminPasswordVisibility()"
                  class="password-toggle">
                  <mat-icon>{{hideAdminPassword ? 'visibility' : 'visibility_off'}}</mat-icon>
                </button>
                <mat-error *ngIf="adminPassword?.invalid && adminPassword?.touched">
                  <span *ngIf="adminPassword?.hasError('required')">La contraseña es requerida</span>
                  <span *ngIf="adminPassword?.hasError('minlength')">Mínimo 8 caracteres</span>
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Action Buttons -->
            <div class="admin-form-actions">
              <button
                mat-flat-button
                type="submit"
                class="admin-submit-btn"
                [disabled]="isRegisteringAdmin || adminRegisterForm.invalid">
                <span *ngIf="!isRegisteringAdmin" class="btn-content">
                  <mat-icon>how_to_reg</mat-icon>
                  Registrar Administrador
                </span>
                <mat-spinner *ngIf="isRegisteringAdmin" diameter="24" class="login-spinner"></mat-spinner>
              </button>

              <button
                mat-stroked-button
                type="button"
                class="admin-cancel-btn"
                (click)="toggleAdminRegister()"
                [disabled]="isRegisteringAdmin">
                <mat-icon>close</mat-icon>
                Cancelar
              </button>
            </div>
          </form>
        </div>

        <!-- Max admins reached message -->
        <div *ngIf="!canRegisterAdmin" class="admin-limit-message">
          <mat-icon>info</mat-icon>
          <span>Se alcanzó el límite máximo de {{ maxAdmins }} administradores</span>
        </div>
      </div>

      <!-- Footer -->
      <div class="login-footer">
        <div class="version-info">
          <span>FitNova Dashboard v1.0.0</span>
          <span class="developer">Por Carlos Cusme</span>
        </div>
      </div>
    </div>
  </div>
</div>