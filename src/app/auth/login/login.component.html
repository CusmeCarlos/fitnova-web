<!-- src/app/auth/login/login.component.html -->
<!-- LOGIN PREMIUM - HTML CORREGIDO SIN SUPERPOSICIONES -->

<div class="login-container">
  <!-- ==================== LADO IZQUIERDO - ANIMACIÓN GYM ==================== -->
  <div class="animation-section">
    <!-- Background Gradient -->
    <div class="gym-background">
      <div class="gradient-overlay"></div>
    </div>

    <!-- Gym Animation -->
    <div class="gym-animation">
      <div class="content-wrapper">
        <!-- Hero Content -->
        <div class="hero-content">
          <div class="logo-badge">
            <mat-icon>fitness_center</mat-icon>
          </div>
          <h1 class="brand-title">FitNova</h1>
          <p class="brand-subtitle">Sistema de Entrenamiento Inteligente</p>
          <p class="brand-description">Sistema de gestión de entrenamiento con análisis biomecánico mediante IA</p>
        </div>

        <!-- Premium Illustration -->
        <div class="illustration-container">
          <svg viewBox="0 0 400 400" class="training-illustration">
            <!-- Definición de gradientes -->
            <defs>
              <linearGradient id="headGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#60a5fa;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:1" />
              </linearGradient>
              <linearGradient id="torsoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#2563eb;stop-opacity:1" />
              </linearGradient>
              <linearGradient id="legGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#2563eb;stop-opacity:1" />
              </linearGradient>
              <linearGradient id="armGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#60a5fa;stop-opacity:1" />
              </linearGradient>
            </defs>

            <!-- Círculos decorativos de fondo -->
            <circle cx="200" cy="200" r="180" class="circle-bg circle-1"/>
            <circle cx="200" cy="200" r="140" class="circle-bg circle-2"/>
            <circle cx="200" cy="200" r="100" class="circle-bg circle-3"/>

            <!-- Persona entrenando (figura estilizada) -->
            <g class="person-training">
              <!-- Piernas -->
              <path d="M 180 280 L 170 350" class="leg" stroke-width="12" stroke-linecap="round"/>
              <path d="M 220 280 L 230 350" class="leg" stroke-width="12" stroke-linecap="round"/>

              <!-- Torso -->
              <ellipse cx="200" cy="220" rx="35" ry="60" class="torso"/>

              <!-- Cabeza -->
              <circle cx="200" cy="160" r="25" class="head"/>

              <!-- Brazo izquierdo con pesa -->
              <g class="arm-left">
                <path d="M 165 200 L 120 180" class="arm" stroke-width="10" stroke-linecap="round"/>
                <!-- Pesa izquierda -->
                <g class="dumbbell">
                  <rect x="100" y="170" width="8" height="20" rx="2" class="weight-plate"/>
                  <rect x="108" y="175" width="12" height="10" rx="1" class="weight-bar"/>
                  <rect x="120" y="170" width="8" height="20" rx="2" class="weight-plate"/>
                </g>
              </g>

              <!-- Brazo derecho con pesa -->
              <g class="arm-right">
                <path d="M 235 200 L 280 180" class="arm" stroke-width="10" stroke-linecap="round"/>
                <!-- Pesa derecha -->
                <g class="dumbbell">
                  <rect x="272" y="170" width="8" height="20" rx="2" class="weight-plate"/>
                  <rect x="280" y="175" width="12" height="10" rx="1" class="weight-bar"/>
                  <rect x="292" y="170" width="8" height="20" rx="2" class="weight-plate"/>
                </g>
              </g>
            </g>

            <!-- Partículas de energía -->
            <circle cx="150" cy="150" r="4" class="energy-particle particle-1"/>
            <circle cx="250" cy="160" r="3" class="energy-particle particle-2"/>
            <circle cx="180" cy="120" r="3" class="energy-particle particle-3"/>
            <circle cx="220" cy="130" r="4" class="energy-particle particle-4"/>
            <circle cx="160" cy="250" r="3" class="energy-particle particle-5"/>
            <circle cx="240" cy="260" r="4" class="energy-particle particle-6"/>
          </svg>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">
              <mat-icon>psychology</mat-icon>
            </div>
            <div class="stat-content">
              <h4>Análisis IA</h4>
              <p>Evaluación postural</p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">
              <mat-icon>show_chart</mat-icon>
            </div>
            <div class="stat-content">
              <h4>Seguimiento</h4>
              <p>Progreso detallado</p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">
              <mat-icon>assessment</mat-icon>
            </div>
            <div class="stat-content">
              <h4>Dashboard</h4>
              <p>Métricas en tiempo real</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== LADO DERECHO - FORMULARIO LOGIN ==================== -->
  <div class="form-section">
    <div class="login-card" [class.animated]="isFormAnimated">
      <!-- Header -->
      <div class="login-header">
        <h2>Acceso al Sistema</h2>
        <p>Panel de Administración & Entrenadores FitNova</p>
      </div>

      <!-- Formulario -->
      <form [formGroup]="loginForm" (ngSubmit)="onLogin()" class="login-form">
        <!-- Email Field -->
        <div class="form-group">
          <mat-form-field appearance="outline" class="premium-field">
            <mat-label>Correo Electrónico</mat-label>
            <input 
              matInput 
              type="email"
              formControlName="email"
              placeholder="admin@fitnova.com"
              autocomplete="email">
            <mat-icon matPrefix>email</mat-icon>
            <mat-error *ngIf="email?.invalid && email?.touched">
              <span *ngIf="email?.hasError('required')">El correo es requerido</span>
              <span *ngIf="email?.hasError('email')">Ingresa un correo válido</span>
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Password Field -->
        <div class="form-group">
          <mat-form-field appearance="outline" class="premium-field">
            <mat-label>Contraseña</mat-label>
            <input 
              matInput 
              [type]="hidePassword ? 'password' : 'text'"
              formControlName="password"
              placeholder="••••••••"
              autocomplete="current-password">
            <mat-icon matPrefix>lock</mat-icon>
            <button 
              mat-icon-button 
              matSuffix 
              type="button"
              (click)="togglePasswordVisibility()"
              class="password-toggle">
              <mat-icon>{{hidePassword ? 'visibility' : 'visibility_off'}}</mat-icon>
            </button>
            <mat-error *ngIf="password?.invalid && password?.touched">
              <span *ngIf="password?.hasError('required')">La contraseña es requerida</span>
              <span *ngIf="password?.hasError('minlength')">Mínimo 6 caracteres</span>
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Remember Me -->
        <div class="form-options">
          <label class="remember-checkbox">
            <input type="checkbox">
            <span class="checkmark"></span>
            Recordarme
          </label>
          <a routerLink="/auth/forgot-password" class="forgot-password">¿Olvidaste tu contraseña?</a>
        </div>

        <!-- Login Button -->
        <button 
          mat-flat-button 
          type="submit"
          class="login-btn"
          [disabled]="isLoading || loginForm.invalid">
          <span *ngIf="!isLoading" class="btn-content">
            <mat-icon>login</mat-icon>
            Iniciar Sesión
          </span>
          <mat-spinner *ngIf="isLoading" diameter="24" class="login-spinner"></mat-spinner>
        </button>
      </form>

      <!-- Admin Registration Section -->
      <div class="admin-section" *ngIf="!isLoadingAdminCheck">
        <!-- Show registration button if available -->
        <div *ngIf="canRegisterAdmin && !showAdminRegister" class="admin-register-btn-container">
          <button
            mat-stroked-button
            type="button"
            class="admin-register-btn"
            (click)="toggleAdminRegister()">
            <mat-icon>admin_panel_settings</mat-icon>
            Registrar Administrador ({{ currentAdmins }}/{{ maxAdmins }})
          </button>
        </div>

        <!-- Admin Registration Form -->
        <div *ngIf="showAdminRegister" class="admin-register-form">
          <div class="admin-form-header">
            <div class="admin-badge-icon">
              <mat-icon>shield</mat-icon>
            </div>
            <h3>Registro de Administrador</h3>
            <div class="admin-counter">
              <span class="counter-badge">{{ currentAdmins + 1 }}/{{ maxAdmins }}</span>
              <span class="counter-text">Administrador {{ currentAdmins + 1 }}</span>
            </div>
          </div>

          <form [formGroup]="adminRegisterForm" (ngSubmit)="onRegisterAdmin()">
            <!-- Display Name -->
            <div class="form-group">
              <mat-form-field appearance="outline" class="premium-field">
                <mat-label>Nombre Completo</mat-label>
                <input
                  matInput
                  type="text"
                  formControlName="displayName"
                  placeholder="Carlos Cusme"
                  autocomplete="name">
                <mat-icon matPrefix>person</mat-icon>
                <mat-error *ngIf="adminDisplayName?.invalid && adminDisplayName?.touched">
                  <span *ngIf="adminDisplayName?.hasError('required')">El nombre es requerido</span>
                  <span *ngIf="adminDisplayName?.hasError('minlength')">Mínimo 3 caracteres</span>
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Email -->
            <div class="form-group">
              <mat-form-field appearance="outline" class="premium-field">
                <mat-label>Correo Electrónico</mat-label>
                <input
                  matInput
                  type="email"
                  formControlName="email"
                  placeholder="admin@fitnova.com"
                  autocomplete="email">
                <mat-icon matPrefix>email</mat-icon>
                <mat-error *ngIf="adminEmail?.invalid && adminEmail?.touched">
                  <span *ngIf="adminEmail?.hasError('required')">El correo es requerido</span>
                  <span *ngIf="adminEmail?.hasError('email')">Ingresa un correo válido</span>
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Password -->
            <div class="form-group">
              <mat-form-field appearance="outline" class="premium-field">
                <mat-label>Contraseña</mat-label>
                <input
                  matInput
                  [type]="hideAdminPassword ? 'password' : 'text'"
                  formControlName="password"
                  placeholder="••••••••"
                  autocomplete="new-password">
                <mat-icon matPrefix>lock</mat-icon>
                <button
                  mat-icon-button
                  matSuffix
                  type="button"
                  (click)="toggleAdminPasswordVisibility()"
                  class="password-toggle">
                  <mat-icon>{{hideAdminPassword ? 'visibility' : 'visibility_off'}}</mat-icon>
                </button>
                <mat-error *ngIf="adminPassword?.invalid && adminPassword?.touched">
                  <span *ngIf="adminPassword?.hasError('required')">La contraseña es requerida</span>
                  <span *ngIf="adminPassword?.hasError('minlength')">Mínimo 8 caracteres</span>
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Action Buttons -->
            <div class="admin-form-actions">
              <button
                mat-flat-button
                type="submit"
                class="admin-submit-btn"
                [disabled]="isRegisteringAdmin || adminRegisterForm.invalid">
                <span *ngIf="!isRegisteringAdmin" class="btn-content">
                  <mat-icon>how_to_reg</mat-icon>
                  Registrar Administrador
                </span>
                <mat-spinner *ngIf="isRegisteringAdmin" diameter="24" class="login-spinner"></mat-spinner>
              </button>

              <button
                mat-stroked-button
                type="button"
                class="admin-cancel-btn"
                (click)="toggleAdminRegister()"
                [disabled]="isRegisteringAdmin">
                <mat-icon>close</mat-icon>
                Cancelar
              </button>
            </div>
          </form>
        </div>

        <!-- Max admins reached message -->
        <div *ngIf="!canRegisterAdmin" class="admin-limit-message">
          <mat-icon>info</mat-icon>
          <span>Se alcanzó el límite máximo de {{ maxAdmins }} administradores</span>
        </div>
      </div>

      <!-- Footer -->
      <div class="login-footer">
        <div class="version-info">
          <span>FitNova v1.0 - Proyecto de Tesis</span>
          <span class="developer">Desarrollado por Carlos Cusme</span>
        </div>
      </div>
    </div>
  </div>
</div>